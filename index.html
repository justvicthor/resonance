<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>Resonance</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- JSmol core (hostato da St. Olaf College) -->
  <script src="https://chemapps.stolaf.edu/jmol/jsmol/JSmol.min.js" defer></script>

  <!-- CSS principale -->
  <link rel="stylesheet" href="css/styles.css" />

  <!-- Markdown renderer (per formattare le risposte AI) -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js" defer></script>

  <!-- JS dell'app -->
  <script src="js/app.js" defer></script>
</head>
<body>
  <div class="app-shell">
    <div class="app-inner">
      <header>
        <div class="brand">
          <div class="brand-logo">
            <div class="brand-logo-inner">
              <img src="icons/resonance_128px.png" alt="Resonance logo" />
            </div>
          </div>
          <div>
            <div class="brand-text-title">Resonance</div>
            <div class="brand-text-sub">
              <span data-i18n="brand.tagline">
                A free 3D molecule visualizer based on JSmol
              </span>
            </div>
          </div>
        </div>
        <div class="header-controls">
          <div class="segmented" id="lang-switch">
            <button type="button" data-lang="it" class="active">IT</button>
            <button type="button" data-lang="en">EN</button>
          </div>
          <button
            type="button"
            class="icon-button"
            id="theme-toggle"
            aria-label="Toggle theme"
          >
            <span class="icon" id="theme-icon">‚òæ</span>
          </button>
        </div>
      </header>

      <main>
        <!-- Landing / uploader (left column, spans full height) -->
        <section class="landing" id="landing">
          <div class="landing-inner" id="landing-card">
            <h1 class="hero-title" data-i18n="hero.title">
              Visualizza le tue molecole in 3D
            </h1>
            <p class="hero-subtitle" data-i18n="hero.subtitle">
              Carica un file o incolla il suo contenuto testuale per
              esplorare la struttura, la superficie e il potenziale elettrico
              in tempo reale.
            </p>

            <div class="uploader-card">
              <!-- File upload -->
              <div>
                <div class="uploader-block-title">
                  <span data-i18n="upload.fileTitle">Carica un file</span>
                  <div class="pill-row">
                    <span class="pill-small">.mol2</span>
                    <span class="pill-small">.pdb</span>
                  </div>
                </div>
                <label for="pdb-file-input" class="file-drop" id="file-drop-area">
                  <div class="file-drop-icon">‚¨ÜÔ∏è</div>
                  <div style="flex: 1 1 auto;">
                    <div class="file-drop-content-main">
                      <strong data-i18n="upload.dropTitle">
                        Trascina qui il file
                      </strong>
                      <span data-i18n="upload.dropOr"> o clicca per selezionarlo</span>
                    </div>
                    <div class="file-drop-content-sub" data-i18n="upload.dropSubtitle">
                      Formati supportati: <code>.pdb</code>, <code>.mol</code>, <code>.mol2</code>.
                    </div>
                  </div>
                  <div class="file-drop-badge" id="file-name-badge" data-i18n="upload.badgeEmpty">
                    Nessun file selezionato
                  </div>
                  <input type="file" id="pdb-file-input" accept=".pdb,.mol2,.mol" />
                </label>
              </div>

              <!-- PDB text -->
              <div>
                <div class="uploader-block-title">
                  <span data-i18n="upload.textTitle">Oppure incolla il contenuto del file</span>
                </div>
                <textarea
                  id="pdb-textarea"
                  class="pdb-textarea"
                  spellcheck="false"
                  data-i18n-placeholder="upload.textPlaceholder"
                ></textarea>
                <div class="textarea-hint">
                  <span data-i18n="upload.textHintBottom">
                    Puoi incollare l'intero file, non √® necessario modificare le righe.
              </div>

              <!-- Footer -->
              <div class="uploader-footer">
                <button type="button" class="primary-btn" id="load-button">
                  <span class="icon">üöÄ</span>
                  <span data-i18n="upload.loadButton">Carica molecola</span>
                </button>
              </div>
            </div>

            <div class="error-banner" id="error-banner"></div>
          </div>
        </section>

        <!-- Viewer (right column, top) -->
        <section class="viewer-panel">
          <div class="viewer-header">
            <div class="viewer-title-group">
              <div class="viewer-title" data-i18n="viewer.title">Viewer 3D</div>
              <div class="viewer-subtitle" id="viewer-subtitle" data-i18n="viewer.subtitleEmpty">
                In attesa di una molecola...
              </div>
            </div>
            <div class="viewer-chip-row">
              <div class="viewer-chip" data-i18n="viewer.chip1">Mouse: drag = ruota</div>
              <div class="viewer-chip" data-i18n="viewer.chip2">Scroll = zoom</div>
            </div>
          </div>
          <div class="viewer-body">
            <div class="viewer-canvas-wrapper">
              <div class="viewer-canvas" id="viewer-canvas">
                <div id="jsmol-container"></div>
                <div class="viewer-placeholder" id="viewer-placeholder">
                  <div class="viewer-placeholder-icon">üß¨</div>
                  <p data-i18n="viewer.placeholder">
                    Carica un file o incolla il suo contenuto per iniziare a esplorare la molecola in 3D.
                  </p>
                </div>
              </div>
            </div>

            <div class="viewer-controls">
              <div class="control-group">
                <button type="button" class="toggle-btn" id="spin-toggle">
                  <span class="status-dot"></span>
                  <span data-i18n="controls.spinOff">Spin off</span>
                </button>
                <button type="button" class="toggle-btn" id="surface-toggle">
                  <span class="status-dot"></span>
                  <span data-i18n="controls.surfaceOff">Surface off</span>
                </button>
                <button type="button" class="toggle-btn" id="epm-toggle">
                  <span class="status-dot"></span>
                  <span data-i18n="controls.epmOff">EPM off</span>
                </button>
                <button type="button" class="toggle-btn" id="vdw-toggle">
                  <span class="status-dot"></span>
                  <span data-i18n="controls.vdwOff">vdW off</span>
                </button>
              </div>
              <div class="viewer-legend">
                <span data-i18n="viewer.legendLabel">EPM:</span>
                <div class="epm-swatches">
                  <div class="epm-swatch red"></div>
                  <div class="epm-swatch green"></div>
                  <div class="epm-swatch blue"></div>
                </div>
                <span data-i18n="viewer.legendText">
                  rosso = pi√π elettronegativo, verde ‚âà neutro, blu = meno elettronegativo
                </span>
              </div>
            </div>
          </div>
        </section>

        <!-- Ask Resonance AI (right column, bottom) -->
        <section class="ai-panel" id="ai-panel">
          <div class="ai-header">
            <div class="ai-header-main">
              <div class="ai-logo">
                <img src="icons/ai_purple_64px.png" alt="Resonance AI logo" />
              </div>
              <div>
                <div class="ai-title" data-i18n="ai.title">Resonance AI</div>
                <div class="ai-subtitle" data-i18n="ai.subtitle">
                  Fai domande sulla molecola caricata: legami, geometria, propriet√†, farmacologia‚Ä¶
                </div>
              </div>
            </div>
          </div>

          <div class="ai-body">
            <div class="ai-messages" id="ai-messages">
              <div class="ai-message ai-message-model">
                <div class="ai-message-bubble" data-i18n="ai.welcome">
                  Carica una molecola e chiedimi qualsiasi cosa su legami, geometria,
                  propriet√† fisico-chimiche o farmacologia.
                </div>
              </div>
            </div>

            <form class="ai-input-row" id="ai-form">
              <textarea
                id="ai-input"
                class="ai-input"
                rows="2"
                spellcheck="true"
                data-i18n-placeholder="ai.placeholder"
              ></textarea>
              <button type="submit" class="ai-send-btn" id="ai-send-btn">
                <span class="icon">‚û§</span>
                <span data-i18n="ai.send">Invia</span>
              </button>
            </form>

            <div class="ai-footnote" id="ai-footnote">
              <span data-i18n="ai.disclaimer">
                Le risposte sono solo a scopo informativo e non sostituiscono il parere di un medico
                o le norme di sicurezza di laboratorio.
              </span>
            </div>
          </div>
        </section>
      </main>
    </div>
  </div>
</body>
</html>